<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">  
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css')}}">
    <title>{% block title %}{% endblock %}</title>
</head>
<body class="d-flex flex-column min-vh-100">
    <header class="border-bottom py-3 mb-4">
      <div class="container d-flex flex-wrap align-items-center justify-content-between gap-3">
        <a href="/" class="d-inline-flex link-body-emphasis text-decoration-none" aria-label="Home">
          <img src="{{ url_for('static', filename='img/k_icon.jpeg')}}" class="k_icon" alt="Home">
        </a>
        <ul class="nav mb-2 mb-md-0 justify-content-center flex-grow-1">
          <li><a href="{{ url_for('index') }}" class="nav-link px-2 {% block home_link%}{% endblock %}">Home</a></li>
          <li><a href="{{ url_for('posts') }}" class="nav-link px-2 {% block all_posts_link %}{% endblock %}">All posts</a></li>
          {% if session.get('user_id') %}
          <li><a href="{{ url_for('create') }}" class="nav-link px-2 {% block create_link %}{% endblock %}">Create post</a></li>
          {% endif %}
        </ul>
        <div class="text-end">
          {% if session.get('user_id') %}
            <a href="{{ url_for('logout') }}" class="btn btn-outline-danger me-2">Logout</a>
          {% else %}
            <a href="{{ url_for('login') }}" class="btn btn-outline-primary me-2">Login</a>
            <a href="{{ url_for('register') }}" class="btn btn-primary">Sign-up</a>
          {% endif %}
        </div>
      </div>
    </header>
    <main class="flex-fill d-flex">
        {% block content %}
        {% endblock %}
    </main>
    <footer class="border-top py-3 mt-5 mb-1">
      <div class="container d-flex flex-wrap justify-content-between align-items-center gap-3">
        <div class="d-flex align-items-center">
          <a href="/" class="me-2 text-body-secondary text-decoration-none lh-1" aria-label="Home">
            <img src="{{ url_for('static', filename='img/k_icon.jpeg')}}" class="k_icon" alt="Home">
          </a>
          <span class="text-body-secondary">Â© 2025 Kostiantyn Lysenko, Wingor Inc.</span>
        </div>
        <ul class="nav justify-content-end list-unstyled d-flex">
          <li class="ms-3">
            <a class="text-body-secondary" href="https://github.com/WingorOsnova" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
              <img src="{{ url_for('static', filename='img/github_icon.jpeg')}}" class="github_icon" alt="GitHub">
            </a>
          </li>
          <li class="ms-3">
            <a class="text-body-secondary" href="#" aria-label="Facebook">
              <svg class="bi" width="24" height="24"><use xlink:href="#facebook"></use></svg>
            </a>
          </li>
        </ul>
      </div>
    </footer>
    <script>
      // Read more / Show less toggle for any .post-card
      document.addEventListener('click', function(e) {
        const link = e.target.closest('.read-more');
        if (!link) return;
        e.preventDefault();
        const card = link.closest('.post-card');
        const p = card && card.querySelector('p');
        if (!p) return;
        const alt = link.getAttribute('data-toggle-text') || 'Show less';
        if (p.classList.toggle('expanded')) {
          link.setAttribute('data-toggle-text', link.textContent.trim());
          link.textContent = alt;
        } else {
          const prev = link.getAttribute('data-toggle-text') || 'Read more';
          link.setAttribute('data-toggle-text', link.textContent.trim());
          link.textContent = prev;
        }
      });

      // Simple horizontal slider for homepage .posts-slider
      function initSlider(root) {
        const viewport = root.querySelector('.slider-viewport');
        const prev = root.querySelector('.slider-btn.prev');
        const next = root.querySelector('.slider-btn.next');
        if (!viewport || !prev || !next) return;
        const update = () => {
          const max = viewport.scrollWidth - viewport.clientWidth;
          prev.disabled = viewport.scrollLeft <= 0;
          next.disabled = viewport.scrollLeft >= max - 1;
        };
        prev.addEventListener('click', () => {
          viewport.scrollBy({ left: -viewport.clientWidth, behavior: 'smooth' });
        });
        next.addEventListener('click', () => {
          viewport.scrollBy({ left: viewport.clientWidth, behavior: 'smooth' });
        });
        viewport.addEventListener('scroll', update, { passive: true });
        window.addEventListener('resize', update);
        update();
      }
      document.querySelectorAll('.posts-slider').forEach(initSlider);
    </script>
</body>
</html>
